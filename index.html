<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLA San Isidro - Panel de GestiÃ³n</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Montserrat', sans-serif;
            min-height: 100vh;
            background: #30115e;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                radial-gradient(circle at 20% 20%, rgba(255,255,255,0.04) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255,255,255,0.04) 0%, transparent 50%),
                repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(255,255,255,0.015) 40px, rgba(255,255,255,0.015) 41px);
            pointer-events: none;
        }

        .orb { position: fixed; border-radius: 50%; filter: blur(80px); pointer-events: none; opacity: 0.3; }
        .orb-1 { width: 400px; height: 400px; background: #5b21b6; top: -100px; left: -100px; }
        .orb-2 { width: 350px; height: 350px; background: #1e0a3c; bottom: -80px; right: -80px; }
        .orb-3 { width: 250px; height: 250px; background: #7c3aed; top: 50%; left: 50%; transform: translate(-50%, -50%); }

        /* â”€â”€ PANTALLA LOGIN â”€â”€ */
        #login-screen {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 40px 24px;
            width: 100%;
            max-width: 420px;
            animation: fadeInUp 0.6s ease both;
        }

        .login-logo {
            width: 72px; height: 72px;
            background: rgba(167,139,250,0.15);
            border: 1px solid rgba(167,139,250,0.3);
            border-radius: 20px;
            display: flex; align-items: center; justify-content: center;
            font-size: 34px;
            margin: 0 auto 24px;
        }

        .login-title {
            font-size: 26px; font-weight: 900; color: white;
            letter-spacing: -0.5px; margin-bottom: 8px;
        }
        .login-title span { color: #a78bfa; }

        .login-subtitle {
            font-size: 14px; color: rgba(255,255,255,0.5);
            margin-bottom: 36px; line-height: 1.6;
        }

        .login-box {
            background: rgba(255,255,255,0.07);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 20px;
            padding: 32px 28px;
            backdrop-filter: blur(10px);
        }

        .login-box-title {
            font-size: 15px; font-weight: 700; color: white;
            margin-bottom: 6px;
        }
        .login-box-sub {
            font-size: 12px; color: rgba(255,255,255,0.4);
            margin-bottom: 24px; line-height: 1.5;
        }

        /* Contenedor del botÃ³n de Google */
        #google-btn-container {
            display: flex;
            justify-content: center;
        }

        .login-error {
            display: none;
            margin-top: 16px;
            padding: 10px 16px;
            background: rgba(239,68,68,0.15);
            border: 1px solid rgba(239,68,68,0.3);
            border-radius: 8px;
            font-size: 13px;
            color: #fca5a5;
            font-weight: 500;
        }

        /* â”€â”€ PANTALLA PRINCIPAL (despuÃ©s de login) â”€â”€ */
        #app-screen {
            display: none;
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 40px 20px;
            width: 100%;
            max-width: 900px;
            animation: fadeInUp 0.5s ease both;
        }

        /* Header de usuario */
        .user-bar {
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 12px 20px;
            gap: 10px;
        }

        .user-name {
            font-size: 13px;
            font-weight: 600;
            color: rgba(255,255,255,0.6);
        }

        .user-avatar {
            width: 36px; height: 36px;
            border-radius: 50%;
            border: 2px solid rgba(167,139,250,0.5);
            object-fit: cover;
            cursor: pointer;
        }

        .user-avatar-placeholder {
            width: 36px; height: 36px;
            border-radius: 50%;
            background: rgba(167,139,250,0.3);
            border: 2px solid rgba(167,139,250,0.5);
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; font-weight: 700; color: white;
            cursor: pointer;
        }

        .logout-btn {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 8px;
            color: rgba(255,255,255,0.5);
            font-size: 12px; font-weight: 600;
            padding: 6px 12px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            transition: all 0.2s;
        }
        .logout-btn:hover { background: rgba(255,255,255,0.14); color: white; }

        .logo-area { margin-bottom: 50px; animation: fadeInDown 0.6s ease both; }

        .logo-badge {
            display: inline-flex; align-items: center; gap: 12px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 100px; padding: 10px 24px;
            margin-bottom: 24px; backdrop-filter: blur(10px);
        }
        .logo-dot { width: 8px; height: 8px; background: #a78bfa; border-radius: 50%; animation: pulse 2s ease infinite; }
        .logo-text { font-size: 13px; font-weight: 600; color: rgba(255,255,255,0.7); letter-spacing: 2px; text-transform: uppercase; }

        h1 { font-size: clamp(28px, 5vw, 48px); font-weight: 900; color: white; line-height: 1.1; letter-spacing: -1px; margin-bottom: 16px; }
        h1 span { color: #a78bfa; }
        .subtitle { font-size: 16px; font-weight: 400; color: rgba(255,255,255,0.55); max-width: 400px; margin: 0 auto; line-height: 1.6; }

        .cards-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 50px; animation: fadeInUp 0.7s ease 0.2s both; }

        .card {
            background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px; padding: 36px 28px; cursor: pointer;
            text-decoration: none; display: block;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px); text-align: left; position: relative; overflow: hidden;
        }
        .card::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(255,255,255,0.08), transparent); opacity: 0; transition: opacity 0.3s ease; }
        .card:hover { border-color: rgba(167, 139, 250, 0.5); background: rgba(255,255,255,0.1); transform: translateY(-4px); box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 0 1px rgba(167,139,250,0.2); }
        .card:hover::before { opacity: 1; }
        .card:active { transform: translateY(-2px); }

        .card-icon { width: 60px; height: 60px; border-radius: 16px; background: rgba(167,139,250,0.15); border: 1px solid rgba(167,139,250,0.2); display: flex; align-items: center; justify-content: center; margin-bottom: 20px; font-size: 28px; transition: all 0.3s ease; }
        .card:hover .card-icon { background: rgba(167,139,250,0.25); transform: scale(1.05); }
        .card-title { font-size: 20px; font-weight: 700; color: white; margin-bottom: 10px; line-height: 1.2; }
        .card-desc { font-size: 14px; font-weight: 400; color: rgba(255,255,255,0.5); line-height: 1.6; }

        .card-arrow { position: absolute; bottom: 28px; right: 28px; width: 32px; height: 32px; border-radius: 50%; background: rgba(167,139,250,0.15); display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
        .card:hover .card-arrow { background: #a78bfa; transform: translateX(3px); }
        .card-arrow svg { width: 16px; height: 16px; fill: rgba(255,255,255,0.7); }
        .card:hover .card-arrow svg { fill: white; }

        .footer { margin-top: 50px; font-size: 12px; color: rgba(255,255,255,0.25); font-weight: 500; letter-spacing: 1px; animation: fadeInUp 0.7s ease 0.4s both; }

        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp   { from { opacity: 0; transform: translateY(20px);  } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse      { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(0.8); } }

        @media (max-width: 600px) {
            .cards-grid { grid-template-columns: 1fr; gap: 16px; }
            body { overflow: auto; justify-content: flex-start; }
            #app-screen { padding: 60px 20px 60px; }
        }
    </style>
</head>
<body>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <!-- â”€â”€ PANTALLA DE LOGIN â”€â”€ -->
    <div id="login-screen">
        <div class="login-logo">ğŸ›ï¸</div>
        <div class="login-title">La Libertad Avanza<br><span>San Isidro</span></div>
        <p class="login-subtitle">Panel interno de gestiÃ³n legislativa</p>

        <div class="login-box">
            <div class="login-box-title">Acceso restringido</div>
            <div class="login-box-sub">IniciÃ¡ sesiÃ³n con tu cuenta de Google autorizada para continuar</div>
            <div id="google-btn-container"></div>
            <div class="login-error" id="login-error">
                â›” Tu cuenta no tiene acceso a este panel. ContactÃ¡ al administrador.
            </div>
        </div>
    </div>

    <!-- â”€â”€ PANTALLA PRINCIPAL â”€â”€ -->
    <div id="app-screen">
        <!-- Barra de usuario (arriba a la derecha) -->
        <div class="user-bar">
            <span class="user-name" id="user-name"></span>
            <div id="user-avatar-wrap"></div>
            <button class="logout-btn" onclick="logout()">Salir</button>
        </div>

        <div class="logo-area">
            <div class="logo-badge">
                <div class="logo-dot"></div>
                <span class="logo-text">Panel de GestiÃ³n</span>
            </div>
            <h1>La Libertad Avanza<br><span>San Isidro</span></h1>
            <p class="subtitle">SeleccionÃ¡ el mÃ³dulo con el que querÃ©s trabajar</p>
        </div>

        <div class="cards-grid">
            <a href="mapa.html" class="card">
                <div class="card-icon">ğŸ—ºï¸</div>
                <div class="card-title">Mapa de<br>Reclamos</div>
                <div class="card-desc">Seguimiento en tiempo real de reclamos municipales georeferenciados</div>
                <div class="card-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
            </a>
            <a href="biblioteca.html" class="card">
                <div class="card-icon">ğŸ“š</div>
                <div class="card-title">Biblioteca de<br>Proyectos</div>
                <div class="card-desc">GestiÃ³n y seguimiento de proyectos legislativos por comisiÃ³n y estado</div>
                <div class="card-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
            </a>
        </div>

        <div class="footer">LA LIBERTAD AVANZA Â· SAN ISIDRO Â· 2025</div>
    </div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIGURACIÃ“N â€” EDITÃ ESTOS DOS VALORES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// 1. Tu Google OAuth Client ID (ver instrucciones abajo)
const GOOGLE_CLIENT_ID = '1075702581464-tsratjj30ri932j3i8dt9huo8vr1k64f.apps.googleusercontent.com';

// 2. Emails autorizados a entrar al panel
const EMAILS_AUTORIZADOS = [
    'vivekaandersen2@gmail.com',
    'robrandan@gmail.com',
    'martuccialejandro@gmail.com',
    'Dani.0601@hotmail.com',
    'dani.0601@hotmail.com',
    'ailuoldani@gmail.com',
    'pacusgarces@gmail.com',
    'maximofrancisco@hotmail.com',
    'federico.colomboroque@gmail.com',
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH LOGIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function decodeJWT(token) {
    try {
        return JSON.parse(atob(token.split('.')[1]));
    } catch(e) { return null; }
}

function onGoogleSignIn(response) {
    const payload = decodeJWT(response.credential);
    if (!payload) { mostrarError(); return; }

    const email = payload.email;
    if (!EMAILS_AUTORIZADOS.includes(email)) {
        mostrarError();
        return;
    }

    // Guardar sesiÃ³n
    const user = {
        email,
        name:    payload.name,
        picture: payload.picture,
        given_name: payload.given_name
    };
    sessionStorage.setItem('lla_user', JSON.stringify(user));

    mostrarApp(user);
}

function mostrarError() {
    document.getElementById('login-error').style.display = 'block';
}

function mostrarApp(user) {
    document.getElementById('login-screen').style.display = 'none';
    document.getElementById('app-screen').style.display = 'block';

    // Nombre
    document.getElementById('user-name').textContent = user.given_name || user.name;

    // Avatar
    const wrap = document.getElementById('user-avatar-wrap');
    if (user.picture) {
        wrap.innerHTML = `<img src="${user.picture}" class="user-avatar" title="${user.name}" referrerpolicy="no-referrer">`;
    } else {
        const inicial = (user.name || 'U')[0].toUpperCase();
        wrap.innerHTML = `<div class="user-avatar-placeholder" title="${user.name}">${inicial}</div>`;
    }
}

function logout() {
    sessionStorage.removeItem('lla_user');
    google.accounts.id.disableAutoSelect();
    document.getElementById('app-screen').style.display = 'none';
    document.getElementById('login-screen').style.display = 'block';
    document.getElementById('login-error').style.display = 'none';
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.onload = function() {
    // Chequear si ya hay sesiÃ³n activa
    const saved = sessionStorage.getItem('lla_user');
    if (saved) {
        try {
            const user = JSON.parse(saved);
            if (EMAILS_AUTORIZADOS.includes(user.email)) {
                mostrarApp(user);
                return;
            }
        } catch(e) {}
    }

    // Inicializar Google Sign-In
    google.accounts.id.initialize({
        client_id: GOOGLE_CLIENT_ID,
        callback: onGoogleSignIn,
        auto_select: false,
    });

    google.accounts.id.renderButton(
        document.getElementById('google-btn-container'),
        {
            theme: 'filled_blue',
            size: 'large',
            shape: 'pill',
            text: 'signin_with',
            locale: 'es',
            width: 280
        }
    );
};
</script>
</body>
</html>
